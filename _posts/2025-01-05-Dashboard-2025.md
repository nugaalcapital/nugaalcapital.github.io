

---
title: "Important plots for 2025"
output: 
  flexdashboard::flex_dashboard:
    orientation: columns
    vertical_layout: fill
---

```{r setup, include=FALSE}
library(ggplot2)
library(plotly)
library(plyr)
library(flexdashboard)
library(tidyquant)
library(fredr)
library(tidyverse)
library(reshape2)


```

Comparing Trump 2016 to Trump 2024
=======================================================================

Row
-----------------------------------------------------------------------

### DXY

```{r}
df <- tribble( 
  ~"symbol", ~"title",
  "DX-Y.NYB", "DXY"
) %>%
  tq_get(
    get = "stock.prices",
    from = "2016-01-01"
  ) %>%
  select(date, close) %>%
  na.omit()


df1 <- df %>%
  filter(date >= "2016-11-09" & date <= "2017-10-01")

df2 <- df %>%
  filter(date >= "2024-11-06")

df1$index <- c(1:nrow(df1))
df2$index <- c(1:nrow(df2))

df1 <- df1 %>%
  mutate(close = 100*close/first(close)) %>%
  select(index, close)
df2 <- df2 %>%
  mutate(close = 100*close/first(close)) %>%
  select(index, close)
  

p <- left_join(df1,df2,by="index") %>%
  set_names(c("index","2016", "2024")) %>%
  melt(., id.vars = "index") %>%
  set_names(c("index", "Year", "value")) %>%
  ggplot(.) +
  geom_line(aes(x = index, y = value, colour = Year)) +
  geom_vline(xintercept = 75, linetype="dotted") +
  scale_y_continuous(breaks = seq(0,200,1)) +
  scale_x_continuous(breaks = seq(0,500,20)) + 
  xlab("Days from Election result") + 
  ylab("DXY Index") +
  labs(title = "DXY 2024 vs DXY 2016 post election", 
       caption = "Source: Yahoo") + 
  theme_bw()
ggplotly(p)
```


### Bitcoin

```{r}
df1 <- tribble( 
  ~"symbol", ~"title",
  "CBBTCUSD", "Bitcoin"
) %>%
  tq_get(
    get = "economic.data",
    from = "2016-01-01"
  ) %>%
  select(date, price) %>%
  filter(date >= "2016-11-09" & date <= "2017-10-01") %>%
  mutate(Year2016 = (price/first(price)) - 1) %>%
  mutate(index = seq(1:nrow(.)))

df2 <- tribble( 
  ~"symbol", ~"title",
  "CBBTCUSD", "Bitcoin"
) %>%
  tq_get(
    get = "economic.data",
    from = "2016-01-01"
  ) %>%
  select(date, price) %>%
  filter(date >= "2024-11-06") %>%
  mutate(Year2016 = (price/first(price)) - 1) %>%
  mutate(index = seq(1:nrow(.)))
  
p <- left_join(df1[,c(4,3)],df2[,c(4,3)],by="index") %>%
  set_names(c("index","2016", "2024")) %>%
  melt(., id.vars = "index") %>%
  set_names(c("index", "Year", "value")) %>%
  ggplot(.) +
  geom_line(aes(x = index, y = value, colour = Year)) +
  geom_vline(xintercept = 75, linetype="dotted") +
  scale_y_continuous(breaks = seq(-1,10,0.5), labels = scales::percent) +
  scale_x_continuous(breaks = seq(0,500,25)) + 
  xlab("Days from Election result") + 
  ylab("BTC") +
  labs(title = "BTC 2024 vs BTC 2016 post election", 
       caption = "Source: FRED") + 
  theme_bw()
ggplotly(p)
```

Row
-----------------------------------------------------------------------

### TGA

```{r}
df <- tribble( 
  ~"symbol", ~"title",
  "WTREGEN", "TGA"
) %>%
  tq_get(
    get = "economic.data",
    from = "2016-01-01"
  ) %>%
  select(date, price)


df1 <- df %>%
  filter(date >= "2016-11-09" & date <= "2017-10-01")

df2 <- df %>%
  filter(date >= "2024-11-06")

df1$index <- c(1:nrow(df1))
df2$index <- c(1:nrow(df2))

df1 <- df1 %>%
  mutate(price = (price/first(price)) - 1) %>%
  select(index, price)
df2 <- df2 %>%
  mutate(price = (price/first(price)) - 1) %>%
  select(index, price)


p <- left_join(df1,df2,by="index") %>%
  set_names(c("index","2016", "2024")) %>%
  melt(., id.vars = "index") %>%
  set_names(c("index", "Year", "value")) %>%
  ggplot(.) +
  geom_line(aes(x = index, y = value, colour = Year)) +
  geom_vline(xintercept = 10, linetype="dotted") +
  scale_y_continuous(breaks = seq(-1,1,0.2), labels = scales::percent) +
  scale_x_continuous(breaks = seq(0,100,5)) + 
  xlab("Weeks from Election result") + 
  ylab("TGA") +
  labs(title = "TGA 2024 vs TGA 2016 post election", 
       caption = "Source: FRED") + 
  theme_bw()
ggplotly(p)
```

### MMFR

```{r}
df <- tribble( 
  ~"symbol", ~"title",
  "WRMFNS", "MMFR"
) %>%
  tq_get(
    get = "economic.data",
    from = "2016-01-01"
  ) %>%
  select(date, price)


df1 <- df %>%
  filter(date >= "2016-11-09" & date <= "2017-10-01")

df2 <- df %>%
  filter(date >= "2024-11-06")

df1$index <- c(1:nrow(df1))
df2$index <- c(1:nrow(df2))

df1 <- df1 %>%
  mutate(price = (price/first(price)) - 1) %>%
  select(index, price)
df2 <- df2 %>%
  mutate(price = (price/first(price)) - 1) %>%
  select(index, price)


p <- left_join(df1,df2,by="index") %>%
  set_names(c("index","2016", "2024")) %>%
  melt(., id.vars = "index") %>%
  set_names(c("index", "Year", "value")) %>%
  ggplot(.) +
  geom_line(aes(x = index, y = value, colour = Year)) +
  geom_vline(xintercept = 10, linetype="dotted") +
  scale_y_continuous(breaks = seq(-1,1,0.005), labels = scales::percent) +
  scale_x_continuous(breaks = seq(0,100,5)) + 
  xlab("Weeks from Election result") + 
  ylab("MMFR") +
  labs(title = "MMFR 2024 vs MMFR 2016 post election", 
       caption = "Source: FRED") + 
  theme_bw()
ggplotly(p)
```

